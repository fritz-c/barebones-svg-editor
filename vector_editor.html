<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="UTF-8">
    <style type="text/css">
        .vector-display,
        .vector-zoomed-preview {
            position: relative;
            z-index: 5;
        }

        .editor {
            position: relative;
            height: 400px;
            width: 600px;
        }

        .display-container,
        .preview-container {
            border: solid black 4px;
            position: relative;
            overflow: hidden;
        }

        .under-image {
            position: absolute;
            left: 0;
            bottom: 0;
            right: 0;
            top: 0;
            margin: auto;
            max-width: 100%;
            max-height: 100%;
            z-index: 1;
        }
        .under-image-zoomed {
            width: 100%;
            max-height: 100%;
        }
        .code-output {
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <label>
        Vector Width
        <input id="vector-width" type="number" value="30"></input>
    </label>
    <label>
        Vector Height
        <input id="vector-height" type="number" value="30"></input>
    </label>
    <label>
        Zoom Preview Scale
        <input id="vector-zoomed-scale" type="number" value="4"></input>
    </label>
    <label>
        Background Color
        <select id="vector-background-color">
            <option value="white" selected>white</option>
            <option value="black">black</option>
            <option value="yellow">yellow</option>
            <option value="blue">blue</option>
            <option value="red">red</option>
            <option value="gray">gray</option>
        </select>
    </label>

    <div class="display-container">
        <img class="under-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" />
        <div class="vector-display"></div>
    </div>

    <div class="preview-container">
        <img class="under-image under-image-zoomed" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" />
        <div class="vector-zoomed-preview"></div>
    </div>

    <label>
        Underlay Image Select
        <input type='file' id="custom-image-underlay-upload" />
    </label>
    <label>
        Underlay Opacity
        <input id="underlay-opacity" type="number" step="0.2" max="1" min="0" value="0.8"></input>
    </label>

    <div id="editor" class="editor"></div>

    <textarea id="code-output" class="code-output" cols="120" rows="10"></textarea>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.3/ace.js"></script>
    <script type="text/javascript">
        var editor;
        function refreshSvg() {
            var height = $('#vector-height').val();
            var width = $('#vector-width').val();
            var zoomedScale = $('#vector-zoomed-scale').val();
            var backgroundColor = $('#vector-background-color').val();
            var code = editor.getValue();

            // Fix size and general style of preview windows
            $('.display-container').css({
                width              : width,
                height             : height,
                'background-color' : backgroundColor,
            });
            $('.preview-container').css({
                width              : width * zoomedScale,
                height             : height * zoomedScale,
                'background-color' : backgroundColor,
            });

            $('.vector-display').html(
                '<svg width="' + width + '" height="' + height + '">' +
                 code +
                '</svg>'
            );

            $('#code-output').val(
                '<svg xmlns="http://www.w3.org/2000/svg" width="' + width + '" height="' + height + '">' +
                 code.replace(/>\s+</g, '><') +
                '</svg>'
            );

            $('.vector-zoomed-preview').html(
                '<svg width="' + (width * zoomedScale) + '" height="' + (height * zoomedScale) + '">' +
                '<g transform="scale(' + zoomedScale + ')">' +
                 code +
                '</g>' +
                '</svg>'
            );
        }

        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('.under-image').attr('src', e.target.result);
                    $('.under-image').css('opacity', $('#underlay-opacity').val());
                };

                reader.readAsDataURL(input.files[0]);
            }
        }

        $(document).ready(function() {
            editor = ace.edit("editor");
            editor.setTheme("ace/theme/katzenmilch");
            editor.getSession().setMode("ace/mode/svg");
            editor.setValue(
                '<g stroke="#000" stroke-width="2" stroke-linecap="round">' + "\n" +
                '    <path d="M1 19l6-6"/>' + "\n" +
                '    <path d="M9 8h6"/>' + "\n" +
                '    <path d="M12 5v6"/>' + "\n" +
                '</g>' + "\n" +
                '<circle cx="12" cy="8" r="7" fill="none" stroke="#000" stroke-width="2"/>'
            );
            editor.getSession().on('change', refreshSvg);
            $('#vector-width, #vector-height, #vector-zoomed-scale, #vector-background-color').on('change', refreshSvg);

            $("#custom-image-underlay-upload").change(function(){
                readURL(this);
            });
            $('#underlay-opacity').on('change', function() {
                $('.under-image').css('opacity', $(this).val());
            });

            refreshSvg();
        });
    </script>

</body>
</html>
<!--
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20">
  <g stroke="#fff" stroke-width="2" stroke-linecap="round">
    <path d="M1 19l6-6"/>
    <path d="M9 8h6"/>
    <path d="M12 5v6"/>
  </g>
  <circle cx="12" cy="8" r="7" fill="none" stroke="#fff" stroke-width="2"/>
</svg>
 -->
